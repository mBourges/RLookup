!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("classnames"),require("react"),require("immutable"),require("react-dom"),require("rx")):"function"==typeof define&&define.amd?define(["classnames","react","immutable","react-dom","rx"],t):"object"==typeof exports?exports.ReactLookup=t(require("classnames"),require("react"),require("immutable"),require("react-dom"),require("rx")):e.ReactLookup=t(e.classnames,e.react,e.immutable,e["react-dom"],e.rx)}(this,function(e,t,s,r,n){return function(e){function t(r){if(s[r])return s[r].exports;var n=s[r]={exports:{},id:r,loaded:!1};return e[r].call(n.exports,n,n.exports,t),n.loaded=!0,n.exports}var s={};return t.m=e,t.c=s,t.p="",t(0)}([function(e,t,s){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=function(){function e(e,t){for(var s=0;s<t.length;s++){var r=t[s];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,s,r){return s&&e(t.prototype,s),r&&e(t,r),t}}();Object.defineProperty(t,"__esModule",{value:!0});var a=s(2),u=r(a),c=s(6),f=r(c),p=s(7),d=r(p),h=s(1),g=(r(h),s(5)),m=r(g),b=s(3),y=r(b),v=function(e){function t(e){n(this,t);var s=o(this,Object.getPrototypeOf(t).call(this,e));return s.state={results:m["default"].List(),showResultList:!1,isSearching:!1,highlightedIndex:-1,selected:m["default"].Map({})},s}return i(t,e),l(t,[{key:"getSelectedItem",value:function(){return this.state.selected}},{key:"ensureHighlightedVisible",value:function(){if(this.refs.list&&!(this.state.highlightedIndex<0)){this.refs.list&&this.state.highlightedIndex<0&&(f["default"].findDOMNode(this.refs.list).scrollTop=0);var e=f["default"].findDOMNode(this.refs.list),t=e.children[this.state.highlightedIndex];return e.scrollTop=t.offsetTop-e.offsetHeight/2+t.offsetHeight/2,e.scrollTop}}},{key:"isSelectKey",value:function(e){return 13===e.keyCode||40===e.keyCode||38===e.keyCode||9===e.keyCode}},{key:"selectItem",value:function(e){e||(e=m["default"].Map({label:"",value:""})),this.setState({isSearching:!1,showResultList:!1,results:m["default"].List()}),e&&(f["default"].findDOMNode(this.refs.AutocompleteInput).value=e.get("label")),this.setState({selected:e,results:m["default"].List()})}},{key:"componentDidMount",value:function(){var e=this,t=f["default"].findDOMNode(this.refs.AutocompleteInput),s=d["default"].Observable.fromEvent(t,"keydown").filter(function(t){return e.isSelectKey(t)}).map(function(t){var s=t.keyCode,r=e.state.highlightedIndex;switch(s){case 9:r>=0?e.selectItem(e.state.results.get(e.state.highlightedIndex)):e.selectItem(void 0);break;case 13:r>=0?e.selectItem(e.state.results.get(e.state.highlightedIndex)):e.selectItem(void 0);break;case 40:r<e.state.results.size-1&&(r+=1);break;case 38:r>-1&&(r-=1)}return r>-1&&e.ensureHighlightedVisible(),(13===s||40===s||38===s)&&(t.preventDefault(),t.stopPropagation()),{highlightedIndex:r}}),r=function(){return{results:m["default"].List(),showResultList:!1,isSearching:!1,highlightedIndex:-1}},n=d["default"].Observable.fromEvent(t,"blur").map(r),o=null;this.props.options&&(o=d["default"].Observable.fromEvent(t,"keyup").filter(function(t){return!e.isSelectKey(t)}).filter(function(e){return e.target.value.length>1}).debounce(500).distinctUntilChanged().map(function(t){var s=m["default"].fromJS(e.props.options).filter(function(e){var s=new RegExp("^"+t.target.value+".*","i");return s.test(e.get("value"))});return{showResultList:!0,results:s,highlightedIndex:-1}})),this.props.optionsLoader&&(o=d["default"].Observable.fromEvent(t,"keyup").filter(function(t){return!e.isSelectKey(t)}).filter(function(e){return e.target.value.length>1}).debounce(500).distinctUntilChanged().map(function(t){return e.setState({isSearching:!0,showResultList:!0,highlightedIndex:-1,results:m["default"].List()}),t.target.value}).flatMapLatest(function(t){return d["default"].Observable.fromPromise(e.props.optionsLoader)}).map(function(e){return console.log("Promise Results",e),{results:m["default"].fromJS(e),isSearching:!1}})),o.merge(n).merge(s).subscribe(function(t){e.setState(t),console.log(t)},function(e){console.log("Error:"+e)})}},{key:"render",value:function(){var e=this.state.isSearching,t=!this.state.isSearching&&0===this.state.results.size,s=0!==this.state.results.size;return u["default"].createElement("div",{className:"autocomplete"},u["default"].createElement("input",{ref:"AutocompleteInput",className:this.props.inputClassName,placeholder:this.props.placeholder,defaultValue:this.state.selected?this.state.selected.get("label"):""}),this.state.showResultList&&u["default"].createElement(y["default"],{ref:"list",listClassName:this.props.listClassName,listItemClassName:this.props.listItemClassName,options:this.state.results,hasResults:s,displaySearchMessage:e,displayNoResultMessage:t,onMouseDown:this.selectItem.bind(this),highlightedIndex:this.state.highlightedIndex}))}}]),t}(u["default"].Component);t["default"]=v,v.propTypes={options:u["default"].PropTypes.array,optionsLoader:u["default"].PropTypes.object},v.defaultProps={placeholder:"Search"},t["default"]=v},function(t,s){t.exports=e},function(e,s){e.exports=t},function(e,t,s){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=function(){function e(e,t){for(var s=0;s<t.length;s++){var r=t[s];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,s,r){return s&&e(t.prototype,s),r&&e(t,r),t}}();Object.defineProperty(t,"__esModule",{value:!0});var a=s(2),u=r(a),c=s(4),f=r(c),p=s(1),d=r(p),h=function(e){function t(){return n(this,t),o(this,Object.getPrototypeOf(t).apply(this,arguments))}return i(t,e),l(t,[{key:"render",value:function(){var e=this,t=(0,d["default"])(this.props.listClassName,"result-list");return u["default"].createElement("ul",{className:t},this.props.hasResults&&this.props.options.map(function(t,s){return u["default"].createElement(f["default"],{listItemClassName:e.props.listItemClassName,key:s,onMouseDown:e.props.onMouseDown,option:t,highlightedIndex:e.props.highlightedIndex,index:s})}),this.props.displaySearchMessage&&u["default"].createElement("li",null,this.props.searchMessage),this.props.displayNoResultMessage&&u["default"].createElement("li",null,this.props.noResultMessage))}}]),t}(u["default"].Component);h.propTypes={options:u["default"].PropTypes.object.isRequired,hasResults:u["default"].PropTypes.bool.isRequired,displaySearchMessage:u["default"].PropTypes.bool.isRequired,displayNoResultMessage:u["default"].PropTypes.bool.isRequired,onMouseDown:u["default"].PropTypes.func.isRequired,highlightedIndex:u["default"].PropTypes.number.isRequired},h.defaultProps={seachMessage:"Searching...",noResultMeassga:"No Results found."},t["default"]=h},function(e,t,s){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var n=s(2),o=r(n),i=s(1),l=r(i),a=function(e){var t=e.onMouseDown,s=e.option,r=e.highlightedIndex,n=e.index,i=function(){t(s)},a=function(){return r===n},u=(0,l["default"])({active:a()}),c=(0,l["default"])(c,"result-list");return o["default"].createElement("li",{className:c,onMouseDown:i,className:u},s.get("label"))};t["default"]=a},function(e,t){e.exports=s},function(e,t){e.exports=r},function(e,t){e.exports=n}])});